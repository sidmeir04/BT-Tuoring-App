{% extends 'blank.html' %}
{%set user_name = username%}
{%set active_page='dashboard'%}
{% block content %}
<style>
/* Dropdown Button */
.dropbtn {
  background-color: #04AA6D;
  color: white;
  padding: 16px;
  font-size: 16px;
  border: none;
}

/* The container <div> - needed to position the dropdown content */
.dropdown {
  position: relative;
  display: inline-block;
}

/* Dropdown Content (Hidden by Default) */
.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 3;
  right: 0; /* Position the dropdown to the left */
  left: auto; /* Reset the right property */
}

/* Links inside the dropdown */
.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

/* Change color of dropdown links on hover */
.dropdown-content a:hover {background-color: #ddd;}

/* Show the dropdown menu on hover */
.dropdown:hover .dropdown-content {display: block;}

/* Change the background color of the dropdown button when the dropdown content is shown */
.dropdown:hover .dropbtn {background-color: #3e8e41;}
</style>
<!-- Begin Page Content -->
<div class="container-fluid mr-0 pr-0">

    <!-- Page Heading -->
    <!-- the "custom-progress-bar" class can be added to make this into a custom progress bar -->
    <div class="row align-items-center justify-content-center">
        <div class="h5 font-weight-bold text-primary" style="font-size: 3vw;">Progress: <span class="text-{{color}}">{{number*100}}%</span></div>
    </div>
    <div class="progress mb-4 bg-gray-600 rounded-pill" style="height:5vw">
        <div class="progress-bar bg-{{color}} progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="{{number*100}}" style="width:{{number*100}}%" aria-valuemin="0" aria-valuemax="100">
            
        </div>
    </div>
    <div class="row py-2 mb-4 bg-gradient-secondary px-0">
    </div>
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    {% for category, message in messages %}
    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
        <strong>{{ message }}</strong>
        <button type="button" class="btn-close" data-dismiss="alert" aria-label="Close"></button>
    </div>
    {% endfor %}
    {% endif %}
    {% endwith %}   
    <!-- <div class="d-sm-flex align-items-center justify-content-between mb-4">
        <h1 class="h3 mb-0 text-gray-800">Dashboard: Welcome {{username}}</h1>
    </div> -->

    <!-- Content Row -->
    <div class="row px-0">
        <div class="col-xl-8 col-lg-8 pr-0">
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <div class="row">
                        <div class="col-6">
                            <h6 class="m-0 font-weight-bold text-primary">Upcoming Teaching Sessions</h6>
                        </div>
                        <div class="col-6">
                            <h6 class="m-0 font-weight-bold text-primary">Upcoming Learning Sessions</h6>
                        </div>
                    </div>
                </div>
                <div class="card-body align-items-center justify-content-center" style="min-height: 70vh;">
                    <div class="row">
                        <div class="col-6">
                            {%if sessions%}
                            <div class="table-responsive">
                                <table class="table" id="dataTable" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>Start</th>
                                            <th>End</th>
                                            <th>Period</th>
                                            <th>Date</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for session in sessions%}
                                            <tr>
                                                <td>{{session.start_time.strftime("%H:%M")}}</td>
                                                <td>{{session.end_time.strftime("%H:%M")}}</td>
                                                <!-- <td>{User.query.get(session.tutor).username}}</td> --> <td>to be added</td>
                                                <td>{{session.date.strftime("%B")}} {{session.date.strftime("%d")}}</td>
                                                <td>
                                                    <div class="dropdown">
                                                        <button class="btn btn-primary" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                                                        style = "width: 2vw;
                                                        height: 2vw;
                                                        border-radius: 20px;
                                                        background-color: #007bff;
                                                        border: none;
                                                        color: white;
                                                        font-size: 1.2em;
                                                        display: flex;
                                                        align-items: center;
                                                        justify-content: center;
                                                        cursor: pointer;">
                                                            <i class="fa fa-ellipsis-v"></i>
                                                        </button>
                                                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                                            <a class="dropdown-item" href="{{ url_for('details', identification=session.id) }}">Messages</a>
                                                            <a class="dropdown-item" href="/complete_session/{{ session.id }}">Mark as Done</a>
                                                            <a class="dropdown-item" href="/delete_session/{{ session.id }}">Remove Session</a>
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>

                            </div>
                            {%else%}
                            <div class="text-center text-primary h5">
                                No current appointments
                            </div>
                            {%endif%}
                        </div>
                        <div class="col-6">
                            {%if student_sessions%}
                            <div class="table-responsive">
                                <table class="table" id="dataTable" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>Start</th>
                                            <th>End</th>
                                            <th>Period</th>
                                            <th>Date</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for session in student_sessions%}
                                            <tr>
                                                <td>{{session.start_time.strftime("%H:%M")}}</td>
                                                <td>{{session.end_time.strftime("%H:%M")}}</td>
                                                <!-- <td>{User.query.get(session.tutor).username}}</td> --> <td>to be added</td>
                                                <td>{{session.date.strftime("%B")}} {{session.date.strftime("%d")}}</td>
                                                <td>
                                                    <div class="dropdown">
                                                        <button class="btn btn-primary" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                                                        style = "width: 2vw;
                                                        height: 2vw;
                                                        border-radius: 20px;
                                                        background-color: #007bff;
                                                        border: none;
                                                        color: white;
                                                        font-size: 1.2em;
                                                        display: flex;
                                                        align-items: center;
                                                        justify-content: center;
                                                        cursor: pointer;">
                                                            <i class="fa fa-ellipsis-v"></i>
                                                        </button>
                                                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                                            <a class="dropdown-item" href="{{ url_for('details', identification=session.id) }}">Messages</a>
                                                            <a class="dropdown-item" href="/complete_session/{{ session.id }}">Mark as Done</a>
                                                            <a class="dropdown-item" href="/delete_session/{{ session.id }}">Remove Session</a>
                                                        </div>
                                                    </div>
                                                    
                                                </td>
                                            </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>

                            </div>

                            {%else%}
                            <div class="text-center text-primary h5">
                                No current appointments
                            </div>
                            {%endif%}
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>
        <div class="col-xl-4 col-lg-4 pr-0">
            <div class="card shadow mb-3" style="height: 40vh;">
                <div class="card-header p-1">
                    <form class="d-none d-sm-inline-block form-inline mr-auto ml-md-0 my-md-0 mw-100 navbar-search w-100">
                        <div class="input-group w-100">
                            <input type="text" class="form-control border-0 small text-primary" placeholder="Search messages..."
                                aria-label="Search" aria-describedby="basic-addon2">
                            <div class="input-group-append">
                                <button class="btn btn-primary" type="button">
                                    <i class="fas fa-search fa-sm"></i>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="card-body d-flex">
                    <table class="table-responsive table">
                        <tbody>
                            {%for _ in range(9)%}
                            <tr>
                                <td>
                                    <div class="row">
                                        <div class="col-3 d-flex align-items-center justify-content-center">
                                            <img class="img-profile rounded-circle"
                                                src="https://upload.wikimedia.org/wikipedia/commons/2/27/Red_square.svg" 
                                                 style="width: 100%; height:auto;">
                                        </div>
                                        <div class="col-9">
                                            <div class="row d-flex justify-content-between">
                                                <span class="mr-2 d-none d-lg-inline text-gray-900">Username</span>
                                                <div class="rounded-circle bg-danger py-0 px-2">
                                                    <span class="text-white">1</span>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <span class="mr-2 d-none d-lg-inline text-gray-600 small">The message preview goes here</span>

                                            </div>
                                            <!-- <span class="mr-2 d-none d-lg-inline text-gray-900">Username</span><br>
                                            <span class="mr-2 d-none d-lg-inline text-gray-600 small">The message preview goes here</span> -->
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            {%endfor%}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="card shadow mb-4" style="height: 30vh;">
                <div class="card-header p-3">
                    <h6 class="m-0 font-weight-bold text-primary">Session Terminations</h6>
                </div>
                <div class="card-body d-flex">
                    <table class="table-responsive table">
                        <tbody>
                            {%for _ in range(3)%}
                            <tr>
                                <td>
                                    person's name here
                                </td>
                                <td>
                                    Date here
                                </td>
                                <td>
                                    More info
                                </td>
                            </tr>
                            {%endfor%}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="row py-2 mb-4 bg-gradient-secondary px-0">
    </div>
    <div class="row p-1 align-items-center">

        <!-- Earnings (Monthly) Card Example -->
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-primary shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center h-100">
                        <div class="col mr-2">
                            <!-- <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                Earnings (Annual)</div> -->
                            <div class="h5 mb-0 font-weight-bold text-gray-800">Set Schedule</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-calendar fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Earnings (Monthly) Card Example -->
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-success shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center h-100">
                        <div class="col mr-2">
                            <div class="h5 mb-0 font-weight-bold text-gray-800">Check Hours</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-clipboard-list fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Earnings (Monthly) Card Example -->

        <!-- Pending Requests Card Example -->
        <div class="col-xl-6 col-md-12 mb-4">
            <div class="card shadow h-100 py-4">
                <div class="card-body">
                    <div id="movingDisplay" class="text-center">
                        <h4 class="font-weight-bold text-primary mb-3">Moving Display</h4>
                        <div id="movingText" class="text-info font-weight-bold" style="overflow: hidden;">
                            {% for _ in range(10) %}
                                <div class="d-inline-block px-3">
                                    <span>This is some scrolling text!</span>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- /.container-fluid -->
<script>
    var movingText = document.getElementById('movingText');
    var clones = movingText.cloneNode(true);
    movingText.parentNode.appendChild(clones);

    var initialWidth = movingText.offsetWidth;
    var distance = 0;

    function animateText() {
        distance++;
        movingText.style.transform = 'translateX(' + distance + 'px)';
        if (distance >= initialWidth) {
            distance = -initialWidth;
        }
        requestAnimationFrame(animateText);
    }

    animateText();
</script>
{% endblock %}